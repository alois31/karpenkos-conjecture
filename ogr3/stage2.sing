ring R = (0,v1,v2,v3,v4),z(1..3),ws(1..3);
option(redSB);
poly d(1) = 2;
poly d(2) = (-v1);
poly d(3) = (2*v1^2);
poly d(4) = (-8*v1^3-7*v2);
poly d(5) = (26*v1^4+30*v1*v2);
poly d(6) = (-84*v1^5-111*v1^2*v2);
poly d(7) = (300*v1^6+502*v1^3*v2+112*v2^2);
poly d(8) = (-1140*v1^7-2299*v1^4*v2-960*v1*v2^2-127*v3);
poly d(9) = (4334*v1^8+9958*v1^5*v2+5414*v1^2*v2^2+766*v1*v3);
poly d(10) = (-16692*v1^9-43118*v1^6*v2-29579*v1^3*v2^2-3579*v1^2*v3-2380*v2^3);
poly d(11) = (65744*v1^10+189976*v1^7*v2+161034*v1^4*v2^2+17770*v1^3*v3+31012*v1*v2^3+5616*v2*v3);
poly d(12) = (-262400*v1^11-837637*v1^8*v2-838452*v1^5*v2^2-86487*v1^4*v3-240631*v1^2*v2^3-55329*v1*v2*v3);
poly d(13) = (1056540*v1^12+3685550*v1^9*v2+4232750*v1^6*v2^2+404198*v1^5*v3+1600786*v1^3*v2^3+363210*v1^2*v2*v3+58268*v2^4);
poly d(14) = (-4292816*v1^13-16254540*v1^10*v2-21110372*v1^7*v2^2-1864478*v1^6*v3-10071369*v1^4*v2^3-2193009*v1^3*v2*v3-1022466*v1*v2^4-212440*v2^2*v3);
poly d(15) = (17587492*v1^14+71867828*v1^11*v2+104219628*v1^8*v2^2+8581604*v1^7*v3+60190566*v1^5*v2^3+12667346*v1^4*v2*v3+10170952*v1^2*v2^4+2972696*v1*v2^2*v3+65024*v3^2);
poly d(16) = (-72547972*v1^15-318135602*v1^12*v2-509125669*v1^9*v2^2-39306153*v1^8*v3-344343134*v1^6*v2^3-69633465*v1^5*v2*v3-80952889*v1^3*v2^4-25417245*v1^2*v2^2*v3-774272*v1*v3^2-1566096*v2^5-32767*v4);
poly d(17) = (301018182*v1^16+1409811380*v1^13*v2+2467315464*v1^10*v2^2+179108654*v1^9*v3+1912890708*v1^7*v2^3+369459150*v1^6*v2*v3+582069720*v1^4*v2^4+183337206*v1^3*v2^2*v3+5843586*v1^2*v3^2+34397928*v1*v2^5+327678*v1*v4+7689396*v2^3*v3);
poly d(18) = (-1255639624*v1^17-6255574070*v1^14*v2-11886283175*v1^11*v2^2-813910812*v1^10*v3-10400238423*v1^8*v2^3-1918141060*v1^7*v2*v3-3910453466*v1^5*v2^4-1219386327*v1^4*v2^2*v3-38496849*v1^3*v3^2-417728236*v1^2*v2^5-2195451*v1^2*v4-140570558*v1*v2^3*v3-5702412*v2*v3^2);
poly d(19) = (5262628828*v1^18+27789444204*v1^15*v2+56970507034*v1^12*v2^2+3692225644*v1^11*v3+55530445878*v1^9*v2^3+9793463180*v1^8*v2*v3+24892634680*v1^6*v2^4+7624023982*v1^5*v2^2*v3+236404226*v1^4*v3^2+3894670624*v1^3*v2^5+13369322*v1^3*v4+1492191920*v1^2*v2^3*v3+89575780*v1*v2*v3^2+44691472*v2^6+2359280*v2*v4);
poly d(20) = (-22150184180*v1^19-123573798513*v1^16*v2-271843882720*v1^13*v2^2-16722567018*v1^12*v3-292056686117*v1^10*v2^3-49296537369*v1^9*v2*v3-152131894362*v1^7*v2^4-45428237011*v1^6*v2^2*v3-1370643060*v1^5*v3^2-31687915466*v1^4*v2^5-76832679*v1^4*v4-12646090159*v1^3*v2^3*v3-847583014*v1^2*v2*v3^2-1175773848*v1*v2^6-32604065*v1*v2*v4-273872930*v2^4*v3);
poly d(21) = (93585008876*v1^20+550018217882*v1^17*v2+1292291779380*v1^14*v2^2+75641837412*v1^13*v3+1517206007582*v1^11*v2^3+245335267802*v1^10*v2*v3+901384992146*v1^8*v2^4+261422500034*v1^7*v2^2*v3+7619159038*v1^6*v3^2+236515916988*v1^5*v2^5+418840230*v1^5*v4+95518684358*v1^4*v2^3*v3+6598099108*v1^3*v2*v3^2+16850754000*v1^2*v2^6+279576138*v1^2*v2*v4+6204139344*v1*v2^4*v3+342068244*v2^2*v3^2);
poly d(22) = (-396769993556*v1^21-2450247048462*v1^18*v2-6123666831735*v1^15*v2^2-341847664782*v1^14*v3-7800291702827*v1^12*v2^3-1209929450326*v1^11*v2*v3-5208467677147*v1^9*v2^4-1465022224988*v1^8*v2^2*v3-41134703994*v1^7*v3^2-1655422639726*v1^6*v2^5-2201152118*v1^6*v4-667796706253*v1^5*v2^3*v3-46416551318*v1^4*v2*v3^2-180575326224*v1^3*v2^6-2022504241*v1^3*v2*v4-79011371196*v1^2*v2^4*v3-6751236942*v1*v2^2*v3^2-1329669432*v2^7-120782424*v2^2*v4-47743872*v3^3);
poly d(23) = (1687487967968*v1^22+10924338825012*v1^19*v2+28936442315314*v1^16*v2^2+1543873856240*v1^15*v3+39745376859450*v1^13*v2^3+5921820965640*v1^12*v2*v3+29473589430582*v1^10*v2^4+8034393513096*v1^9*v2^2*v3+217202705088*v1^8*v3^2+11025442383356*v1^7*v2^5+11290081356*v1^7*v4+4402659928902*v1^6*v2^3*v3+304014148412*v1^5*v2*v3^2+1646244400684*v1^4*v2^6+13389238834*v1^4*v2*v4+774093491404*v1^3*v2^4*v3+77271880224*v1^2*v2^2*v3^2+40694194728*v1*v2^7+2154491544*v1*v2^2*v4+851026304*v1*v3^3+9718123136*v2^5*v3+50068992*v3*v4);
poly d(24) = (-7197694761920*v1^23-48742253600186*v1^20*v2-136397618708344*v1^17*v2^2-6968841527261*v1^16*v3-200950936883032*v1^14*v2^3-28796074375758*v1^13*v2*v3-163889043635352*v1^11*v2^4-43281839578892*v1^10*v2^2*v3-1126419919353*v1^9*v3^2-70638008756047*v1^8*v2^5-56826637761*v1^8*v4-27757733429468*v1^7*v2^3*v3-1886790167825*v1^6*v2*v3^2-13538135770791*v1^5*v2^6-82991406777*v1^5*v2*v4-6573397362255*v1^4*v2^4*v3-697875690561*v1^3*v2^2*v3^2-671663800390*v1^2*v2^7-22681046013*v1^2*v2^2*v4-8914574112*v1^2*v3^3-262866885292*v1*v2^5*v3-781283457*v1*v3*v4-17457148147*v2^3*v3^2);
poly d(25) = (30781817358220*v1^24+217630197996376*v1^21*v2+641538701690282*v1^18*v2^2+31443794372602*v1^17*v3+1009142447366284*v1^15*v2^3+139254979869324*v1^14*v2*v3+897866223609098*v1^12*v2^4+229735445046948*v1^11*v2^2*v3+5757038029872*v1^10*v3^2+438615954567222*v1^9*v2^5+281660571950*v1^9*v4+169035600607640*v1^8*v2^3*v3+11248787628682*v1^7*v2*v3^2+103325049856412*v1^6*v2^6+489544659110*v1^6*v2*v4+50850975480214*v1^5*v2^4*v3+5542688908444*v1^4*v2^2*v3^2+8141981528756*v1^3*v2^7+191561414390*v1^3*v2^2*v4+74830008828*v1^3*v3^3+3912855746440*v1^2*v2^5*v3+7413672582*v1^2*v3*v4+417255614254*v1*v2^3*v3^2+40786157832*v2^8+5388291636*v2^3*v4+6287179644*v2*v3^3);
poly d(26) = (-131963213356368*v1^25-972334901497608*v1^22*v2-3011606606346630*v1^19*v2^2-141834521904134*v1^18*v3-5037594810513218*v1^16*v2^3-670229453352926*v1^15*v2*v3-4856299480771634*v1^13*v2^4-1204261583839777*v1^12*v2^2*v3-29075614037139*v1^11*v3^2-2653580404971281*v1^10*v2^5-1379117013740*v1^10*v4-1000857964851311*v1^9*v2^3*v3-65014098633455*v1^8*v2*v3^2-744525935604994*v1^7*v2^6-2784749054384*v1^7*v2*v4-367229389653779*v1^6*v2^4*v3-40393524525948*v1^5*v2^2*v3^2-82399186914358*v1^4*v2^7-1438081054191*v1^4*v2^2*v4-557441556158*v1^4*v3^3-43664897470748*v1^3*v2^5*v3-57901066855*v1^3*v3*v4-5626954540671*v1^2*v2^3*v3^2-1422252593640*v1*v2^8-118454456574*v1*v2^3*v4-135868360466*v1*v2*v3^3-345156261152*v2^6*v3-5740004120*v2*v3*v4);
poly d(27) = (567007708129068*v1^26+4346873258745184*v1^23*v2+14113038103361216*v1^20*v2^2+639640853509564*v1^19*v3+25014467406839484*v1^17*v2^3+3212461073781628*v1^16*v2*v3+25974371260824812*v1^14*v2^4+6245299094197194*v1^13*v2^2*v3+145391381093014*v1^12*v3^2+15705308169836194*v1^11*v2^5+6686773746772*v1^11*v4+5789550686690358*v1^10*v2^3*v3+366455355553242*v1^9*v2*v3^2+5126403017191144*v1^8*v2^6+15403542149308*v1^8*v2*v4+2515220689241234*v1^7*v2^4*v3+276130481427956*v1^6*v2^2*v3^2+741459807960320*v1^5*v2^7+9964016376502*v1^5*v2^2*v4+3828713871548*v1^5*v3^3+413146320968736*v1^4*v2^5*v3+406836604538*v1^4*v3*v4+58096746495694*v1^3*v2^3*v3^2+26546778663396*v1^2*v2^8+1485861134448*v1^2*v2^3*v4+1683239703608*v1^2*v2*v3^3+10851379601888*v1*v2^6*v3+111556973016*v1*v2*v3*v4+815538541360*v2^4*v3^2);
poly d(28) = (-2441354809474900*v1^27-19443992621044730*v1^24*v2-66033592713239619*v1^21*v2^2-2884193949033394*v1^20*v3-123623646226057258*v1^18*v2^3-15341714705227275*v1^17*v2*v3-137568733610109614*v1^15*v2^4-32088484823314816*v1^14*v2^2*v3-720908432917820*v1^13*v3^2-91225990728646105*v1^12*v2^5-32158684555218*v1^12*v4-32840917014613989*v1^11*v2^3*v3-2023321074085786*v1^10*v2*v3^2-34020618528933538*v1^9*v2^6-83293668689897*v1^9*v2*v4-16523174761771110*v1^8*v2^4*v3-1797493853714165*v1^7*v2^2*v3^2-6131737159551414*v1^6*v2^7-65013411811501*v1^6*v2^2*v4-24760900829652*v1^6*v3^3-3509151578930015*v1^5*v2^5*v3-2653191142593*v1^5*v3*v4-515623625327524*v1^4*v2^3*v3^2-359275625700101*v1^3*v2^8-14434400900143*v1^3*v2^3*v4-16209816605435*v1^3*v2*v3^3-185007697104942*v1^2*v2^6*v3-1270158629355*v1^2*v2*v3*v4-22963953510277*v1*v2^4*v3^2-1280414568272*v2^9-223818396914*v2^4*v4-516507856370*v2^2*v3^3);
poly d(29) = (10532094994501328*v1^28+87021382036356916*v1^25*v2+308529398340255910*v1^22*v2^2+13003756392557256*v1^21*v3+608362884871240280*v1^19*v2^3+73032650235385082*v1^18*v2*v3+722300023735096860*v1^16*v2^4+163539017246519516*v1^15*v2^2*v3+3548808370106292*v1^14*v3^2+521372799559638814*v1^13*v2^5+153608328935204*v1^13*v4+183210452220158922*v1^12*v2^3*v3+10980810852873120*v1^11*v2*v3^2+218964646422998994*v1^10*v2^6+442114798635898*v1^10*v2*v4+104934001234667512*v1^9*v2^4*v3+11260367272359324*v1^8*v2^2*v3^2+47529819532615748*v1^7*v2^7+405269315435238*v1^7*v2^2*v4+153016787634500*v1^7*v3^3+27555956336425438*v1^6*v2^5*v3+16369568226094*v1^6*v3*v4+4140500847040404*v1^5*v2^3*v3^2+4002031377191042*v1^4*v2^8+121581761646366*v1^4*v2^3*v4+135509512953594*v1^4*v2*v3^3+2321241017087464*v1^3*v2^6*v3+11449954668926*v1^3*v2*v3*v4+357551814029026*v1^2*v2^4*v3^2+50090693452740*v1*v2^9+5868102335888*v1*v2^4*v4+13208788235664*v1*v2^2*v3^3+12290994018752*v2^7*v3+418654146216*v2^2*v3*v4+41078635648*v3^4);
poly d(30) = (-45518000877166932*v1^29-389658874927267194*v1^26*v2-1439698752179788108*v1^23*v2^2-58625571606280024*v1^22*v3-2982311517082936360*v1^20*v2^3-346675552124899778*v1^19*v2*v3-3763103665437968209*v1^17*v2^4-827543174649410345*v1^16*v2^2*v3-17361019533774753*v1^15*v3^2-2937789732472591042*v1^14*v2^5-729511641660422*v1^14*v4-1007499845530101085*v1^13*v2^3*v3-58733026764456757*v1^12*v2*v3^2-1373273756340844589*v1^11*v2^6-2310888397589858*v1^11*v2*v4-647931131619297091*v1^10*v2^4*v3-68381601530327146*v1^9*v2^2*v3^2-349970699300540124*v1^8*v2^7-2437750575828542*v1^8*v2^2*v4-912736596975300*v1^8*v3^3-203702295169907423*v1^7*v2^5*v3-96887572912810*v1^7*v3*v4-30893459726653321*v1^6*v2^3*v3^2-39164614244419337*v1^5*v2^8-931634795739921*v1^5*v2^3*v4-1030683601385603*v1^5*v2*v3^3-24271480562359696*v1^4*v2^6*v3-90633838508907*v1^4*v2*v3*v4-4167659817353429*v1^3*v2^4*v3^2-1042627499507878*v1^2*v2^9-85729689580164*v1^2*v2^4*v4-189688945910916*v1^2*v2^2*v3^3-440153918027728*v1*v2^7*v3-9805629552132*v1*v2^2*v3*v4-975729768384*v1*v3^4-36096719477064*v2^5*v3^2-65993672448*v3^2*v4);
poly d(31) = (197053613594993580*v1^30+1745614704324472016*v1^27*v2+6710256040724334512*v1^24*v2^2+264297682138945952*v1^23*v3+14568881520909692592*v1^21*v2^3+1641436718473000788*v1^20*v2*v3+19469299011589269210*v1^18*v2^4+4161090586421521206*v1^17*v2^2*v3+84470738944863286*v1^16*v3^2+16347940895862573896*v1^15*v2^5+3447648254072440*v1^15*v4+5471441197357577398*v1^14*v2^3*v3+310248229568747438*v1^13*v2*v3^2+8423608629478242218*v1^12*v2^6+11923397814933400*v1^12*v2*v4+3906886755737235042*v1^11*v2^4*v3+404706741505541336*v1^10*v2^2*v3^2+2471343274155879944*v1^9*v2^7+14245952328974980*v1^9*v2^2*v4+5291443273848992*v1^9*v3^3+1435376007143976510*v1^8*v2^5*v3+555215230382500*v1^8*v3*v4+217833636196112886*v1^7*v2^3*v3^2+349122402513616358*v1^6*v2^8+6657594396816150*v1^6*v2^3*v4+7312351471807374*v1^6*v2*v3^3+224903446208680828*v1^5*v2^6*v3+656970074717430*v1^5*v2*v3*v4+40987675560006162*v1^4*v2^4*v3^2+15584418840007904*v1^3*v2^9+945395270366724*v1^3*v2^4*v4+2067975699061380*v1^3*v2^2*v3^3+8458579506729744*v1^2*v2^7*v3+130848745818600*v1^2*v2^2*v3*v4+13095534798912*v1^2*v3^4+1172000586360648*v1*v2^5*v3^2+1409502201088*v1*v3^2*v4+40934917956576*v2^10+8923213479264*v2^5*v4+34008054845600*v2^3*v3^3+8589672448*v4^2);
poly cs(1) = (-1)^1*(d(1)*z(1)+d(2)*z(2)+d(3)*z(3));
poly cs(2) = (-1)^2*(d(1)*z(2)+d(2)*z(3));
poly cs(3) = (-1)^3*(d(1)*z(3));
ideal I =
  cs(1)^2-(2*cs(2)+(v1)*cs(1)*cs(2)+(-3*v1)*cs(3)+(-v1^2)*cs(1)*cs(3)+(-v1^3-v2)*cs(2)*cs(3)),
  cs(2)^2-(2*cs(1)*cs(3)+(v1)*cs(2)*cs(3)),
  cs(3)^2-(0),
  0;
I = std(I);
poly u = reduce(1/2*cs(1)+(-v1)/4*cs(2)+(v1^2)/4*cs(1)*cs(2)+(-3*v1^2)/8*cs(3)+(-5*v1^3-2*v2)/8*cs(1)*cs(3)+(v1^4-v1*v2)/8*cs(2)*cs(3)+(-3*v1^5-5*v1^2*v2)/8*cs(1)*cs(2)*cs(3),I);
